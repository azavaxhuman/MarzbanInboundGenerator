<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=1024" />
    <title>Marzban Inbound Generator</title>
    <link rel="stylesheet" type="text/css" href="style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Vazir:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link rel="icon" type="image/x-icon" href="ico.ico" />
  </head>

  <body onload="protocolDetails()">
    <span id="topcontents">
      <img src="logo.png" alt="logo" id="logo" />
    </span>
    <div id="bodypard">
      <div id="ctext">
        <br />

        <div class="line-numbers">
          <p></p>
        </div>
        <textarea
          id="final"
          style="display: none; width: 100%"
          onload="updateLineNumbers()"
          onclick="protocolDetails()"
        ></textarea>
      </div>
      <div id="content" onchange="protocolDetails()">
        <form id="MainDetails" onchange="actualname()">
          <label for=" protocol">Protocol</label>
          <select name="protocol" id="protocol">
            <option value="vless">VLESS</option>
            <option value="vmess">VMESS</option>
            <option value="trojan">Trojan</option>
            <option value="shadowsocks">Shadowsocks</option>
          </select>

          <div id="transmissions">
            <label for="transmission">Transmission</label>
            <select name="transmission" id="transmission">
              <option value="tcp">TCP</option>
              <option value="ws">WS(Websocket)</option>
              <option value="grpc">GRPC</option>
              <option value="H2" id="H2" style="display: none">H2</option>
            </select>
          </div>

          <div id="NetWorks" style="display: none">
            <label for="NetWork">Network</label>
            <select name="network" id="network">
              <option value="tcpudp">TCP+UDP</option>
              <option value="tcpS">TCP</option>
              <option value="udpS">UDP</option>
            </select>
          </div>

          <div id="idsecurity">
            <label for="security">Security</label>
            <select name="security">
              <option value="none">none</option>
              <option value="tls" id="tls">TLS</option>
              <option value="reality" id="reality">Reality</option>
            </select>
          </div>

          <!-- shadowsocks = -->

          <!-- shadowsocks = -->
        </form>

        <hr style="margin-top: 30px" />

        <form id="protocolDetails" style="display: none">
          <div>
            <label for="name-field">✅ Inbound Name</label>
            <input
              type="text"
              id="inboundname"
              value="Inbound Name"
              name="name-field"
              placeholder="نام اینباند را وارد کنید"
              onchange="protocolDetails()"
            />
            <button
              type="button"
              id="random"
              name="random"
              onclick="randomize ()"
            >
              Random Name
            </button>
            <button
              type="button"
              id="random"
              name="random"
              onclick="actualname()"
              style="background-color: rgb(16, 169, 240); color: rgb(0, 0, 0)"
            >
              Optimal Name
            </button>
          </div>

          <div>
            <label for="number-field">✅ Port </label>
            <input
              type="number"
              id="port"
              name="number-field"
              placeholder="e.g 2053"
              onchange="protocolDetails()"
            />
            <button
              type="button"
              id="randomport"
              name="port"
              onclick="randomports()"
            >
              Random Port
            </button>
          </div>

          <div id="Tls" style="display: none" onchange="protocolDetails()">
            <div>
              <label for="TLS-field">✅ SNI </label>
              <input
                type="text"
                id="sni"
                name="sni-field"
                placeholder="a.example.com"
                onchange="protocolDetails()"
              />
            </div>
            <div>
              <label for="pub-field">✅ Public Key </label>
              <input
                type="text"
                id="pubkey"
                name="pubkey-field"
                placeholder="/root/cert/a.example.com/fullchain.pem"
              />
            </div>
            <div>
              <label for="pv-field">✅ Private Key </label>
              <input
                type="text"
                id="pvkey"
                name="pvkey-field"
                placeholder="/root/cert/a.example.com/Privatekey.pem"
              />
            </div>
          </div>

          <div
            id="RealityForm"
            style="display: none"
            onchange="protocolDetails()"
          >
            <div>
              <label for="TLS-field">✅ dest </label>
              <input
                type="text"
                id="dest"
                name="dest-field"
                placeholder="xray.com:443"
              />
            </div>
            <div>
              <label for="ServerNames-field">✅ ServerNames </label>
              <input
                type="text"
                id="ServerNames"
                name="ServerNames-field"
                placeholder="xray.com,www.xray.com"
              />
            </div>
            <div>
              <label for="ShortIds-field">✅ ShortIds </label>
              <input
                type="text"
                id="ShortIds"
                name="ShortIds-field"
                placeholder="e.g 26c9b62c"
              />
              <button
                type="button"
                id="shortidcopy"
                name="port"
                onclick="copyToClipboardshortID()"
                style="width: 150px"
              >
                ShortId command
              </button>
            </div>
            <!-- <div>
                        <label for="SpiderX-field">✅ SpiderX </label>
                        <input value="/" type="text" id="SpiderX" name="SpiderX-field" placeholder="/">
                    </div> -->
            <div id="publickeyStatus">
              <label for="Public Key-field">✅ PublicKey </label>
              <label class="switch">
                <input
                  type="checkbox"
                  id="publickeyStatusOnOff"
                  onchange="protocolDetails()"
                />

                <span class="slider round"></span>
              </label>
              <label for="publickeyStatus" style="display: -webkit-inline-box"
                >I Have PublicKey!</label
              >
            </div>
            <div id="PublicKeyDiv" style="display: none">
              <input
                type="text"
                id="PublicKey"
                name="Public Key-field"
                placeholder="kMxiGlQa4ubWnhX94SEifF_8CbzeY_kBaLwcMnXw20I"
              />
            </div>
            <div>
              <label for="Private Key-field">✅ PrivateKey </label>
              <input
                type="text"
                id="PrivateKey"
                name="Private Key-field"
                placeholder="958omt37wmklYtS-cQHZAEADGMnml7JX6ShYQn364wk"
              />
            </div>
            <div>
              <button
                type="button"
                id="Keycopy"
                style="width: 220px"
                name="port"
                onclick="copyToClipboardKeys()"
              >
                Public & Private Key Command
              </button>
            </div>
          </div>

          <div id="acceptProxyProtocols">
            <hr style="margin-top: 10px" />

            <label class="switch">
              <input
                type="checkbox"
                id="acceptProxyProtocol"
                onchange="protocolDetails()"
              />

              <span class="slider round"></span>
            </label>
            <label for="acceptProxyProtocol" style="display: -webkit-inline-box"
              >AcceptProxyProtocol</label
            >
          </div>

          <div id="divheader">
            <hr style="margin-top: 10px" />
            <label for="header">Header Type</label>
            <select name="header" id="header" onchange="protocolDetails()">
              <option value="None">None</option>
              <option value="http">http</option>
            </select>

            <div id="http_header_Fields" style="display: none">
              <div>
                <label for="path-field">Path</label>
                <input
                  type="text"
                  id="path"
                  name="path-field"
                  placeholder="/"
                  value="/"
                  onchange="protocolDetails()"
                />
              </div>
              <div id="headerOnOffDiv">
                <label class="switch" style="display: -webkit-inline-box">
                  <input
                    type="checkbox"
                    id="headerOnOff"
                    onchange="protocolDetails()"
                  />
                  <span class="slider round"></span>
                </label>
                <label for="headeron-field" style="display: -webkit-inline-box"
                  >Request Header</label
                >
              </div>
              <div id="sarbarg">
                <center onclick="protocolDetails()">
                  <button id="addFieldsButton" onclick="protocolDetails()">
                    Add Header
                  </button>
                </center>
                <div id="targetDiv" onchange="protocolDetails()">
                  <!-- اینجا فیلدها اضافه خواهند شد -->
                </div>

                <center onclick="protocolDetails()">
                  <button
                    id="removeFieldsButton"
                    style="display: none"
                    onclick="protocolDetails()"
                  >
                    Remove Last one
                  </button>
                </center>
              </div>
              <div id="wsheader" style="display: none">
                <center onclick="protocolDetails()">
                  <div>
                    <input
                      type="text"
                      id="wsheaderfield"
                      name="wsheaderfield"
                      placeholder="xray.com"
                    />
                  </div>
                </center>
              </div>
            </div>
          </div>
          <hr style="margin-top: 10px" />
          <div id="sniffingDiv" onchange="protocolDetails()">
            <label class="switch">
              <input
                type="checkbox"
                id="sniffing"
                onchange="protocolDetails()"
                checked
              />

              <span class="slider round"></span>
            </label>
            <label for="sniffing" style="display: -webkit-inline-box"
              >Sniffing</label
            >
          </div>

          <div id="SniffingCheckbox" onchange="protocolDetails()">
            <table
              style="
                width: 80%;
                margin-left: auto;
                margin-right: auto;
                text-align: center;
              "
            >
              <tbody>
                <tr>
                  <td style="width: 33%">
                    <input
                      type="checkbox"
                      class="group-checkbox"
                      name="http"
                      value="http"
                      checked
                    />
                  </td>
                  <td style="width: 33%">
                    <input
                      type="checkbox"
                      class="group-checkbox"
                      name="tls"
                      value="tls"
                      checked
                    />
                  </td>
                  <td style="width: 33%">
                    <input
                      type="checkbox"
                      class="group-checkbox"
                      name="fakedns"
                      value="fakedns"
                    />
                  </td>
                  <td style="width: 33%">
                    <input
                      type="checkbox"
                      class="group-checkbox"
                      name="quic"
                      value="quic"
                    />
                  </td>
                </tr>
                <tr id="trtable">
                  <td style="width: 33%">HTTP</td>
                  <td style="width: 33%">TLS</td>
                  <td style="width: 33%">FakeDNS</td>
                  <td style="width: 33%">quic</td>
                </tr>
              </tbody>
            </table>
          </div>
          <hr style="margin-top: 50px; background-color: aliceblue" />

          <center>
            <input
              type="button"
              value="Copy to Clipboard!"
              id="sutton"
              onclick="protocolDetails()"
            />
            <input
              type="button"
              value="Download Json File"
              id="sutton"
              style="background-color: rgb(34, 34, 34)"
              onclick="downloadConfig()"
            />
            <input type="button" value="My YouTube Channel" id="youtube" />
            <input
              type="button"
              value="GitHub Repository"
              id="github"
              style="margin-top: 20px"
            />
            <input
              type="button"
              value="Marzban (Gozargah) on Github"
              id="github1"
              style="margin-top: 10px; background-color: bisque; color: black"
            />
          </center>
        </form>
      </div>
    </div>
    <script src="script.js"></script>
    <script>
      function copyToClipboardshortID() {
        var textToCopy = "openssl rand -hex 8";
        var tempInput = document.createElement("input");
        document.body.appendChild(tempInput);
        tempInput.setAttribute("value", textToCopy);
        tempInput.select();
        document.execCommand("copy");
        document.body.removeChild(tempInput);
        alert("متن کپی شد: " + textToCopy);
      }
      function copyToClipboardKeys() {
        var textToCopy = "docker exec marzban-marzban-1 xray x25519";
        var tempInput = document.createElement("input");
        document.body.appendChild(tempInput);
        tempInput.setAttribute("value", textToCopy);
        tempInput.select();
        document.execCommand("copy");
        document.body.removeChild(tempInput);
        alert("متن کپی شد: " + textToCopy);
      }
      function updateLineNumbers() {
        var textarea = document.getElementById("final");
        var lineNumbers = document.querySelector(".line-numbers p");

        // جداکردن متن textarea به خطوط

        // تنظیم متن ستون عمودی
        lineNumbers.innerHTML = "";
        for (var i = 1; i <= 55; i++) {
          lineNumbers.innerHTML += i + "<br>";
        }
      }

      // اجرای ابتدایی
      updateLineNumbers();
      function downloadConfig() {
        // Get the content of the textarea
        const content = document.getElementById("final").value;

        // Create a blob with the content
        const blob = new Blob([content], { type: "application/json" });

        // Create a link element
        const link = document.createElement("a");

        // Create a URL for the blob and set it as the href of the link
        link.href = URL.createObjectURL(blob);

        // Set the download attribute with the filename
        link.download = "config.json";

        // Append the link to the body (it won't be visible)
        document.body.appendChild(link);

        // Programmatically click the link to trigger the download
        link.click();

        // Remove the link from the document
        document.body.removeChild(link);
      }
    </script>
  </body>
</html>
